"use strict";(self.webpackChunkreact_homework_template=self.webpackChunkreact_homework_template||[]).push([[699],{699:function(t,e,n){n.r(e),n.d(e,{default:function(){return lt}});var o=n(9439),r=n(1413),i=n(5987),c=n(2791),a=n(697),l=n(5470),s=n(3896),u=n(3433),d=n(4942),p=n(9509),h=n(9095),f=(n(2151),n(184));p.n(h);var g,x,m,Z,b,j,y,v,C,k,P,S,L,E,T=function(t){var e=t.onCdnUrlsChange,n=(0,c.useState)([]),r=(0,o.Z)(n,2),i=r[0],a=r[1],l=(0,c.useState)([]),s=(0,o.Z)(l,2),d=s[0],p=s[1],h=(0,c.useRef)(null);return(0,c.useEffect)((function(){var t=h.current;if(t){var e=function(t){var e=t.detail.allEntries.filter((function(t){return"success"===t.status}));a(e),p((function(t){var n=e.map((function(t){return{cdnUrl:t.cdnUrl,uuid:t.uuid}}));return[].concat((0,u.Z)(t),(0,u.Z)(n.filter((function(e){return!t.some((function(t){return t.cdnUrl===e.cdnUrl}))}))))}))};return t.addEventListener("change",e),function(){t.removeEventListener("change",e)}}}),[]),(0,c.useEffect)((function(){e(d)}),[d]),(0,f.jsxs)("div",{children:[(0,f.jsx)("lr-config",{"ctx-name":"my-uploader",pubkey:"274c6cf9681b13936265"}),(0,f.jsx)("lr-file-uploader-regular",{"ctx-name":"my-uploader"}),(0,f.jsx)("lr-upload-ctx-provider",{"ctx-name":"my-uploader",ref:h}),(0,f.jsx)("div",{children:i.map((function(t){return(0,f.jsx)("div",{children:(0,f.jsx)("img",{src:t.cdnUrl,alt:t.fileInfo.originalFilename})},t.uuid)}))})]})},U=n(7571),D=n(7338),B=n(3814),F=n(4294),w=n(1686),I=n(168),A=n(8733),_=A.ZP.form(g||(g=(0,I.Z)(["\n  max-width: 600px;\n  padding: 15px;\n  border: 1px solid #8dd3bb;\n  border-radius: 5px;\n  background-color: #fafafa;\n  display: flex;\n  flex-direction: column;\n  gap: 10px;\n  box-shadow: 0px 4px 16px 0px rgba(17, 34, 17, 0.05);\n"]))),N=A.ZP.div(x||(x=(0,I.Z)(["\n  display: flex;\n  flex-direction: column;\n  padding: 15px;\n  border: 1px solid #8dd3bb;\n  border-radius: 5px;\n  margin-bottom: 10px;\n  gap: 10px;\n"]))),z=A.ZP.div(m||(m=(0,I.Z)(["\n  display: flex;\n  gap: 5px;\n"]))),O=A.ZP.div(Z||(Z=(0,I.Z)(["\n  display: flex;\n  align-items: center;\n  gap: 15px;\n  margin-bottom: 7px;\n"]))),J=A.ZP.div(b||(b=(0,I.Z)(["\n  display: flex;\n  align-items: center;\n  gap: 15px;\n"]))),K=A.ZP.div(j||(j=(0,I.Z)(["\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  margin-bottom: 10px;\n"]))),R=U.Z.TextArea,G=function(){var t={title:"",description:"",categories:[{nameCategory:"",todoList:[{todo:""}],publicList:!1}],isPublic:!1,photos:[]},e=(0,c.useState)(t),n=(0,o.Z)(e,2),i=n[0],a=n[1],l=(0,c.useState)([]),s=(0,o.Z)(l,2),p=s[0],h=s[1];(0,c.useEffect)((function(){var t=JSON.parse(localStorage.getItem("data"));t&&a(t)}),[]),(0,c.useEffect)((function(){localStorage.setItem("data",JSON.stringify(i))}),[i]);var g=function(t){var e=t.target,n=e.name,o=e.value;a((function(t){return(0,r.Z)((0,r.Z)({},t),{},(0,d.Z)({},n,o))}))};return(0,f.jsxs)(f.Fragment,{children:[(0,f.jsx)("h1",{children:"Form"}),(0,f.jsxs)(_,{onSubmit:function(e){e.preventDefault();var n=localStorage.getItem("token"),o=(0,r.Z)((0,r.Z)({},i),{},{photos:p});fetch("http://localhost:3000/api/trips",{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(n)},body:JSON.stringify(o)}).then((function(t){return t.json()})).then((function(e){console.log("Response:",e),a(t),localStorage.removeItem("data"),h([]),window.location.reload()})).catch((function(t){console.error("Error:",t)}))},children:[(0,f.jsx)("label",{htmlFor:"title",children:"Title"}),(0,f.jsx)(U.Z,{type:"text",id:"title",name:"title",value:i.title,onChange:g}),(0,f.jsx)("label",{htmlFor:"description",children:"Description"}),(0,f.jsx)(R,{type:"text",id:"description",name:"description",value:i.description,onChange:g}),(0,f.jsx)("h4",{children:"Categories"}),i.categories.map((function(t,e){return(0,f.jsxs)(N,{children:[(0,f.jsx)("label",{htmlFor:"category-".concat(e),children:"Category Name"}),(0,f.jsxs)(O,{children:[(0,f.jsx)(U.Z,{type:"text",id:"category-".concat(e),name:"nameCategory",value:t.nameCategory,onChange:function(t){return function(t,e){var n=t.target,o=n.name,i=n.value;a((function(t){var n=(0,u.Z)(t.categories);return n[e]=(0,r.Z)((0,r.Z)({},n[e]),{},(0,d.Z)({},o,i)),(0,r.Z)((0,r.Z)({},t),{},{categories:n})}))}(t,e)}}),(0,f.jsxs)(z,{children:[(0,f.jsx)("label",{htmlFor:"category-public-".concat(e),children:"Public"}),(0,f.jsx)(D.Z,{type:"checkbox",id:"category-public-".concat(e),name:"publicList",checked:t.publicList,onChange:function(t){return function(t,e){var n=t.target.checked;a((function(t){var o=(0,u.Z)(t.categories);return o[e]=(0,r.Z)((0,r.Z)({},o[e]),{},{publicList:n}),(0,r.Z)((0,r.Z)({},t),{},{categories:o})}))}(t,e)}})]})]}),(0,f.jsx)("label",{children:"Todo List"}),t.todoList.map((function(t,n){return(0,f.jsx)("div",{children:(0,f.jsxs)(O,{children:[(0,f.jsx)(U.Z,{type:"text",id:"todo-".concat(e,"-").concat(n),name:"todo",value:t.todo,onChange:function(t){return function(t,e,n){var o=t.target.value;a((function(t){var i=(0,u.Z)(t.categories),c=(0,u.Z)(i[e].todoList);return c[n]={todo:o},i[e]=(0,r.Z)((0,r.Z)({},i[e]),{},{todoList:c}),(0,r.Z)((0,r.Z)({},t),{},{categories:i})}))}(t,e,n)}}),(0,f.jsx)(B.ZP,{type:"primary",danger:!0,style:{backgroundColor:"#ED5E68"},onClick:function(){return function(t,e){var n=(0,u.Z)(i.categories);n[t].todoList.splice(e,1),a((function(t){return(0,r.Z)((0,r.Z)({},t),{},{categories:n})}))}(e,n)},children:"Delete Todo"})]})},n)})),(0,f.jsxs)(J,{children:[(0,f.jsx)(B.ZP,{type:"primary",style:{backgroundColor:"#8DD3BB"},onClick:function(){return function(t){var e=(0,u.Z)(i.categories);e[t].todoList.push({todo:""}),a((function(t){return(0,r.Z)((0,r.Z)({},t),{},{categories:e})}))}(e)},children:"Add Todo"}),(0,f.jsx)(B.ZP,{type:"primary",style:{backgroundColor:"#ED5E68"},danger:!0,onClick:function(){return function(t){a((function(e){var n=(0,u.Z)(e.categories);return n.splice(t,1),(0,r.Z)((0,r.Z)({},e),{},{categories:n})}))}(e)},children:"Delete Category"})]})]},e)})),(0,f.jsxs)(K,{children:[(0,f.jsx)(B.ZP,{type:"primary",style:{backgroundColor:"#8DD3BB"},onClick:function(){a((function(t){return(0,r.Z)((0,r.Z)({},t),{},{categories:[].concat((0,u.Z)(t.categories),[{nameCategory:"",todoList:[{todo:""}],publicList:!1}])})}))},children:"Add Category"}),(0,f.jsxs)(z,{children:[(0,f.jsx)("label",{htmlFor:"isPublic",children:"Public trip"}),(0,f.jsx)(D.Z,{type:"checkbox",id:"isPublic",name:"isPublic",checked:i.isPublic,onChange:function(t){var e=t.target.checked;a((function(t){return(0,r.Z)((0,r.Z)({},t),{},{isPublic:e})}))}})]})]}),(0,f.jsx)(T,{onCdnUrlsChange:function(t){h(t)}}),(0,f.jsx)(F.Z,{style:{marginTop:"10px",color:"#8DD3BB",borderColor:"#8DD3BB"},variant:"outlined",startIcon:(0,f.jsx)(w.Z,{}),type:"submit",children:"Submit"})]})]})},H=n(6106),Y=n(914),q=n(4889),M=A.ZP.p(y||(y=(0,I.Z)(["\n  color: #666;\n  font-size: 14px;\n  margin-bottom: 16px;\n"]))),Q=A.ZP.h3(v||(v=(0,I.Z)(["\n  margin-bottom: 6px;\n"]))),V=A.ZP.h4(C||(C=(0,I.Z)(["\n  color: #555;\n  margin-bottom: 3px;\n"]))),W=A.ZP.ul(k||(k=(0,I.Z)(["\n  list-style-type: disc;\n  margin-bottom: 6px;\n  margin-left: 15px;\n"]))),X=A.ZP.li(P||(P=(0,I.Z)(["\n  color: #777;\n"]))),$=A.ZP.ul(S||(S=(0,I.Z)(["\n  display: flex;\n  flex-direction: row;\n  flex-wrap: wrap;\n  align-items: center;\n  justify-content: center;\n  gap: 8px;\n"]))),tt=A.ZP.li(L||(L=(0,I.Z)(["\n  width: 150px;\n"]))),et=function(){var t=(0,c.useState)([]),e=(0,o.Z)(t,2),n=e[0],r=e[1],i=localStorage.getItem("token");return(0,c.useEffect)((function(){fetch("http://localhost:3000/api/trips",{headers:{Authorization:"Bearer ".concat(i)}}).then((function(t){return t.json()})).then((function(t){return r(t)})).catch((function(t){return console.error("Error fetching trips:",t)}))}),[i]),(0,f.jsx)(f.Fragment,{children:(0,f.jsx)(H.Z,{gutter:16,children:n.map((function(t){return(0,f.jsx)(Y.Z,{span:8,children:(0,f.jsxs)(q.Z,{style:{marginBottom:"15px"},title:t.title,bordered:!1,headStyle:{backgroundColor:"#8DD3BB",color:"#fafbfc"},children:[(0,f.jsx)(M,{children:t.description}),(0,f.jsx)(Q,{children:"Categories:"}),(0,f.jsx)("ul",{children:t.categories.map((function(t,e){return(0,f.jsxs)("li",{children:[(0,f.jsx)(V,{children:t.nameCategory}),(0,f.jsx)(W,{children:t.todoList.map((function(t,e){return(0,f.jsx)(X,{children:t.todo},e)}))})]},e)}))}),(0,f.jsxs)("p",{children:["Public: ",t.isPublic?"Yes":"No"]}),t.photos.length>0&&(0,f.jsxs)("div",{children:[(0,f.jsx)("h3",{children:"Photos:"}),(0,f.jsx)($,{children:t.photos.map((function(t,e){return(0,f.jsx)(tt,{children:(0,f.jsx)("img",{src:t.cdnUrl,alt:"Photo ".concat(e+1)})},e)}))})]})]})},t._id)}))})})},nt=n(8826),ot=function(){var t={title:"",description:"",categories:[{nameCategory:"",todoList:[{todo:""}],publicList:!1}],isPublic:!1,photos:[]},e=(0,c.useState)(t),n=(0,o.Z)(e,2),i=n[0],a=n[1],l=(0,c.useState)([]),s=(0,o.Z)(l,2),p=s[0],h=s[1],g=(0,c.useState)([]),x=(0,o.Z)(g,2),m=x[0],Z=x[1],b=(0,c.useState)(null),j=(0,o.Z)(b,2),y=j[0],v=j[1],C=(0,c.useState)(!1),k=(0,o.Z)(C,2),P=k[0],S=k[1],L=(0,c.useState)(null),E=(0,o.Z)(L,2),U=E[0],D=E[1];(0,c.useEffect)((function(){var t=localStorage.getItem("token");fetch("http://localhost:3000/api/trips/keys",{method:"GET",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(t)}}).then((function(t){return t.json()})).then((function(t){D(new nt.l7({publicKey:t.publicKey,secretKey:t.secretKey}))})).catch((function(t){console.error("Error fetching keys:",t)}))}),[]),(0,c.useEffect)((function(){var t=JSON.parse(localStorage.getItem("data"));t&&a(t)}),[]),(0,c.useEffect)((function(){localStorage.setItem("data",JSON.stringify(i))}),[i]),(0,c.useEffect)((function(){var t=localStorage.getItem("token");fetch("http://localhost:3000/api/trips",{method:"GET",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(t)}}).then((function(t){return t.json()})).then((function(t){Z(t)})).catch((function(t){console.error("Error fetching trips:",t)}))}),[]);var B=function(t){var e=t.target,n=e.name,o=e.value;a((function(t){return(0,r.Z)((0,r.Z)({},t),{},(0,d.Z)({},n,o))}))};return(0,f.jsxs)(f.Fragment,{children:[(0,f.jsx)("h1",{children:"Form"}),(0,f.jsx)("h2",{children:"Select Trip to Edit"}),(0,f.jsx)("ul",{children:m.map((function(t){return(0,f.jsx)("li",{onClick:function(){return function(t){var e=m.find((function(e){return e._id===t}));a({title:e.title,description:e.description,categories:e.categories.map((function(t){return{nameCategory:t.nameCategory,todoList:t.todoList.map((function(t){return{todo:t.todo}})),publicList:t.publicList}})),isPublic:e.isPublic,photos:e.photos.map((function(t){return{cdnUrl:t.cdnUrl,uuid:t.uuid}}))}),h(e.photos.map((function(t){return t.cdnUrl}))),v(t),S(!0)}(t._id)},children:t.title},t._id)}))}),P&&(0,f.jsxs)(f.Fragment,{children:[(0,f.jsxs)("form",{onSubmit:function(e){e.preventDefault();var n=localStorage.getItem("token"),o="http://localhost:3000/api/trips/".concat(y),c=i.photos.map((function(t){var e=p.find((function(e){return e===t.cdnUrl}));return e?{cdnUrl:e,uuid:t.uuid}:{cdnUrl:t.cdnUrl,uuid:t.uuid}}));p.forEach((function(t){i.photos.find((function(e){return e.cdnUrl===t.cdnUrl}))||c.push({cdnUrl:t.cdnUrl,uuid:t.uuid})}));var l=(0,r.Z)((0,r.Z)({},i),{},{categories:i.categories.map((function(t){return{nameCategory:t.nameCategory,todoList:t.todoList.map((function(t){return{todo:t.todo}})),publicList:t.publicList}})),photos:(0,u.Z)(c)});fetch(o,{method:"PATCH",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(n)},body:JSON.stringify(l)}).then((function(t){return t.json()})).then((function(e){console.log("Response:",e),a(t),localStorage.removeItem("data"),h([])})).catch((function(t){console.error("Error:",t)}))},children:[(0,f.jsx)("label",{htmlFor:"title",children:"Title"}),(0,f.jsx)("input",{type:"text",id:"title",name:"title",value:i.title,onChange:B}),(0,f.jsx)("label",{htmlFor:"description",children:"Description"}),(0,f.jsx)("textarea",{type:"text",id:"description",name:"description",value:i.description,onChange:B}),(0,f.jsx)("h2",{children:"Categories"}),i.categories.map((function(t,e){return(0,f.jsxs)("div",{children:[(0,f.jsx)("label",{htmlFor:"category-".concat(e),children:"Category Name"}),(0,f.jsx)("input",{type:"text",id:"category-".concat(e),name:"nameCategory",value:t.nameCategory,onChange:function(t){return function(t,e){var n=t.target,o=n.name,i=n.value;a((function(t){var n=(0,u.Z)(t.categories);return n[e]=(0,r.Z)((0,r.Z)({},n[e]),{},(0,d.Z)({},o,i)),(0,r.Z)((0,r.Z)({},t),{},{categories:n})}))}(t,e)}}),(0,f.jsx)("label",{htmlFor:"category-public-".concat(e),children:"Public"}),(0,f.jsx)("input",{type:"checkbox",id:"category-public-".concat(e),name:"publicList",checked:t.publicList,onChange:function(t){return function(t,e){var n=t.target.checked;a((function(t){var o=(0,u.Z)(t.categories);return o[e]=(0,r.Z)((0,r.Z)({},o[e]),{},{publicList:n}),(0,r.Z)((0,r.Z)({},t),{},{categories:o})}))}(t,e)}}),(0,f.jsx)("h3",{children:"Todo List"}),t.todoList.map((function(t,n){return(0,f.jsxs)("div",{children:[(0,f.jsx)("label",{htmlFor:"todo-".concat(e,"-").concat(n),children:"Todo"}),(0,f.jsx)("input",{type:"text",id:"todo-".concat(e,"-").concat(n),name:"todo",value:t.todo,onChange:function(t){return function(t,e,n){var o=t.target.value;a((function(t){var i=(0,u.Z)(t.categories),c=(0,u.Z)(i[e].todoList);return c[n]={todo:o},i[e]=(0,r.Z)((0,r.Z)({},i[e]),{},{todoList:c}),(0,r.Z)((0,r.Z)({},t),{},{categories:i})}))}(t,e,n)}}),(0,f.jsx)("button",{type:"button",onClick:function(){return function(t,e){var n=(0,u.Z)(i.categories);n[t].todoList.splice(e,1),a((function(t){return(0,r.Z)((0,r.Z)({},t),{},{categories:n})}))}(e,n)},children:"Delete Todo"})]},n)})),(0,f.jsx)("button",{type:"button",onClick:function(){return function(t){var e=(0,u.Z)(i.categories);e[t].todoList.push({todo:""}),a((function(t){return(0,r.Z)((0,r.Z)({},t),{},{categories:e})}))}(e)},children:"Add Todo"}),(0,f.jsx)("button",{type:"button",onClick:function(){return function(t){a((function(e){var n=(0,u.Z)(e.categories);return n.splice(t,1),(0,r.Z)((0,r.Z)({},e),{},{categories:n})}))}(e)},children:"Delete Category"})]},e)})),(0,f.jsx)("button",{type:"button",onClick:function(){a((function(t){return(0,r.Z)((0,r.Z)({},t),{},{categories:[].concat((0,u.Z)(t.categories),[{nameCategory:"",todoList:[{todo:""}],publicList:!1}])})}))},children:"Add Category"}),(0,f.jsx)("label",{htmlFor:"isPublic",children:"Public"}),(0,f.jsx)("input",{type:"checkbox",id:"isPublic",name:"isPublic",checked:i.isPublic,onChange:function(t){var e=t.target.checked;a((function(t){return(0,r.Z)((0,r.Z)({},t),{},{isPublic:e})}))}}),(0,f.jsx)("ul",{children:i.photos.map((function(t,e){return(0,f.jsxs)("li",{children:[(0,f.jsx)("img",{src:t.cdnUrl,alt:"Trip photo ".concat(e)}),(0,f.jsx)("button",{onClick:function(){return function(t){var e=(0,u.Z)(i.photos),n=e.splice(t,1)[0];(0,nt._I)({uuid:n.uuid},{authSchema:U}).then((function(){console.log("Photo successfully deleted from Uploadcare")})).catch((function(t){console.error("Error deleting photo from Uploadcare:",t)})),a((function(t){return(0,r.Z)((0,r.Z)({},t),{},{photos:e})}))}(e)},children:"Delete"})]},e)}))}),(0,f.jsx)(T,{onCdnUrlsChange:function(t){h(t)}}),(0,f.jsx)("button",{type:"submit",children:"Submit"})]}),(0,f.jsx)("button",{type:"button",onClick:function(){var e=localStorage.getItem("token"),n="http://localhost:3000/api/trips/".concat(y),o=i.photos.map((function(t){return t.uuid}));fetch(n,{method:"DELETE",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(e)}}).then((function(t){return t.json()})).then((function(e){console.log("Trip deleted:",e),a(t),localStorage.removeItem("data"),h([]),S(!1),Z(m.filter((function(t){return t._id!==y})))})).catch((function(t){console.error("Error deleting trip:",t)})),o.length>0&&(0,nt.c1)({uuids:o},{authSchema:U}).then((function(){console.log("Photos successfully deleted from Uploadcare: ".concat(o.join(", ")))})).catch((function(t){console.error("Error deleting photos from Uploadcare:",t)}))},children:"Delete Trip"})]})]})},rt=A.ZP.div(E||(E=(0,I.Z)(["\n  width: 1262px;\n  margin: 0 auto;\n  padding-left: 15px;\n  padding-right: 15px;\n  margin-top: 70px;\n"]))),it=["children","value","index"];function ct(t){var e=t.children,n=t.value,o=t.index,c=(0,i.Z)(t,it);return(0,f.jsx)("div",(0,r.Z)((0,r.Z)({role:"tabpanel",hidden:n!==o,id:"simple-tabpanel-".concat(o),"aria-labelledby":"simple-tab-".concat(o)},c),{},{children:n===o&&(0,f.jsx)(a.Z,{sx:{p:3},children:e})}))}function at(t){return{id:"simple-tab-".concat(t),"aria-controls":"simple-tabpanel-".concat(t)}}var lt=function(){var t=c.useState(0),e=(0,o.Z)(t,2),n=e[0],i=e[1];return(0,f.jsx)(rt,{children:(0,f.jsxs)(a.Z,{sx:{width:"100%"},children:[(0,f.jsx)(a.Z,{sx:{borderBottom:1,borderColor:"divider"},children:(0,f.jsxs)(l.Z,{value:n,onChange:function(t,e){i(e)},"aria-label":"user tabs",centered:!0,children:[(0,f.jsx)(s.Z,(0,r.Z)({label:"Add Trip"},at(0))),(0,f.jsx)(s.Z,(0,r.Z)({label:"All Trips"},at(1))),(0,f.jsx)(s.Z,(0,r.Z)({label:"Update Trip"},at(2)))]})}),(0,f.jsx)(ct,{value:n,index:0,children:(0,f.jsx)(G,{})}),(0,f.jsx)(ct,{value:n,index:1,children:(0,f.jsx)(et,{})}),(0,f.jsx)(ct,{value:n,index:2,children:(0,f.jsx)(ot,{})})]})})}}}]);
//# sourceMappingURL=699.e37e0020.chunk.js.map