"use strict";(self.webpackChunkreact_homework_template=self.webpackChunkreact_homework_template||[]).push([[431],{431:function(t,e,n){n.r(e),n.d(e,{default:function(){return H}});var o=n(9439),r=n(1413),i=n(5987),c=n(2791),a=n(697),u=n(981),l=n(3896),s=n(890),d=n(3433),h=n(4942),p=n(9509),f=n(9095),g=(n(2151),n(184));p.n(f);var x,m,Z,j,b,v,y,C,S=function(t){var e=t.onCdnUrlsChange,n=(0,c.useState)([]),r=(0,o.Z)(n,2),i=r[0],a=r[1],u=(0,c.useState)([]),l=(0,o.Z)(u,2),s=l[0],h=l[1],p=(0,c.useRef)(null);return(0,c.useEffect)((function(){var t=p.current;if(t){var e=function(t){var e=t.detail.allEntries.filter((function(t){return"success"===t.status}));a(e),h((function(t){var n=e.map((function(t){return{cdnUrl:t.cdnUrl,uuid:t.uuid}}));return[].concat((0,d.Z)(t),(0,d.Z)(n.filter((function(e){return!t.some((function(t){return t.cdnUrl===e.cdnUrl}))}))))}))};return t.addEventListener("change",e),function(){t.removeEventListener("change",e)}}}),[]),(0,c.useEffect)((function(){e(s)}),[s]),(0,g.jsxs)("div",{children:[(0,g.jsx)("lr-config",{"ctx-name":"my-uploader",pubkey:"274c6cf9681b13936265"}),(0,g.jsx)("lr-file-uploader-regular",{"ctx-name":"my-uploader"}),(0,g.jsx)("lr-upload-ctx-provider",{"ctx-name":"my-uploader",ref:p}),(0,g.jsx)("div",{children:i.map((function(t){return(0,g.jsx)("div",{children:(0,g.jsx)("img",{src:t.cdnUrl,alt:t.fileInfo.originalFilename})},t.uuid)}))})]})},k=function(){var t={title:"",description:"",categories:[{nameCategory:"",todoList:[{todo:""}],publicList:!1}],isPublic:!1,photos:[]},e=(0,c.useState)(t),n=(0,o.Z)(e,2),i=n[0],a=n[1],u=(0,c.useState)([]),l=(0,o.Z)(u,2),s=l[0],p=l[1];(0,c.useEffect)((function(){var t=JSON.parse(localStorage.getItem("data"));t&&a(t)}),[]),(0,c.useEffect)((function(){localStorage.setItem("data",JSON.stringify(i))}),[i]);var f=function(t){var e=t.target,n=e.name,o=e.value;a((function(t){return(0,r.Z)((0,r.Z)({},t),{},(0,h.Z)({},n,o))}))};return(0,g.jsxs)(g.Fragment,{children:[(0,g.jsx)("h1",{children:"Form"}),(0,g.jsxs)("form",{onSubmit:function(e){e.preventDefault();var n=localStorage.getItem("token"),o=(0,r.Z)((0,r.Z)({},i),{},{photos:s});fetch("http://localhost:3000/api/trips",{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(n)},body:JSON.stringify(o)}).then((function(t){return t.json()})).then((function(e){console.log("Response:",e),a(t),localStorage.removeItem("data"),p([]),window.location.reload()})).catch((function(t){console.error("Error:",t)}))},children:[(0,g.jsx)("label",{htmlFor:"title",children:"Title"}),(0,g.jsx)("input",{type:"text",id:"title",name:"title",value:i.title,onChange:f}),(0,g.jsx)("label",{htmlFor:"description",children:"Description"}),(0,g.jsx)("input",{type:"text",id:"description",name:"description",value:i.description,onChange:f}),(0,g.jsx)("h2",{children:"Categories"}),i.categories.map((function(t,e){return(0,g.jsxs)("div",{children:[(0,g.jsx)("label",{htmlFor:"category-".concat(e),children:"Category Name"}),(0,g.jsx)("input",{type:"text",id:"category-".concat(e),name:"nameCategory",value:t.nameCategory,onChange:function(t){return function(t,e){var n=t.target,o=n.name,i=n.value;a((function(t){var n=(0,d.Z)(t.categories);return n[e]=(0,r.Z)((0,r.Z)({},n[e]),{},(0,h.Z)({},o,i)),(0,r.Z)((0,r.Z)({},t),{},{categories:n})}))}(t,e)}}),(0,g.jsx)("label",{htmlFor:"category-public-".concat(e),children:"Public"}),(0,g.jsx)("input",{type:"checkbox",id:"category-public-".concat(e),name:"publicList",checked:t.publicList,onChange:function(t){return function(t,e){var n=t.target.checked;a((function(t){var o=(0,d.Z)(t.categories);return o[e]=(0,r.Z)((0,r.Z)({},o[e]),{},{publicList:n}),(0,r.Z)((0,r.Z)({},t),{},{categories:o})}))}(t,e)}}),(0,g.jsx)("h3",{children:"Todo List"}),t.todoList.map((function(t,n){return(0,g.jsxs)("div",{children:[(0,g.jsx)("label",{htmlFor:"todo-".concat(e,"-").concat(n),children:"Todo"}),(0,g.jsx)("input",{type:"text",id:"todo-".concat(e,"-").concat(n),name:"todo",value:t.todo,onChange:function(t){return function(t,e,n){var o=t.target.value;a((function(t){var i=(0,d.Z)(t.categories),c=(0,d.Z)(i[e].todoList);return c[n]={todo:o},i[e]=(0,r.Z)((0,r.Z)({},i[e]),{},{todoList:c}),(0,r.Z)((0,r.Z)({},t),{},{categories:i})}))}(t,e,n)}}),(0,g.jsx)("button",{type:"button",onClick:function(){return function(t,e){var n=(0,d.Z)(i.categories);n[t].todoList.splice(e,1),a((function(t){return(0,r.Z)((0,r.Z)({},t),{},{categories:n})}))}(e,n)},children:"Delete Todo"})]},n)})),(0,g.jsx)("button",{type:"button",onClick:function(){return function(t){var e=(0,d.Z)(i.categories);e[t].todoList.push({todo:""}),a((function(t){return(0,r.Z)((0,r.Z)({},t),{},{categories:e})}))}(e)},children:"Add Todo"}),(0,g.jsx)("button",{type:"button",onClick:function(){return function(t){a((function(e){var n=(0,d.Z)(e.categories);return n.splice(t,1),(0,r.Z)((0,r.Z)({},e),{},{categories:n})}))}(e)},children:"Delete Category"})]},e)})),(0,g.jsx)("button",{type:"button",onClick:function(){a((function(t){return(0,r.Z)((0,r.Z)({},t),{},{categories:[].concat((0,d.Z)(t.categories),[{nameCategory:"",todoList:[{todo:""}],publicList:!1}])})}))},children:"Add Category"}),(0,g.jsx)("label",{htmlFor:"isPublic",children:"Public"}),(0,g.jsx)("input",{type:"checkbox",id:"isPublic",name:"isPublic",checked:i.isPublic,onChange:function(t){var e=t.target.checked;a((function(t){return(0,r.Z)((0,r.Z)({},t),{},{isPublic:e})}))}}),(0,g.jsx)(S,{onCdnUrlsChange:function(t){p(t)}}),(0,g.jsx)("button",{type:"submit",children:"Submit"})]})]})},L=n(6106),P=n(914),E=n(3983),T=n(168),U=n(8733),F=U.ZP.p(x||(x=(0,T.Z)(["\n  color: #666;\n  font-size: 14px;\n  line-height: 5px;\n  margin-bottom: 16px;\n"]))),I=U.ZP.h3(m||(m=(0,T.Z)(["\n  margin-bottom: 6px;\n"]))),w=U.ZP.h4(Z||(Z=(0,T.Z)(["\n  color: #555;\n  margin-bottom: 3px;\n"]))),A=U.ZP.ul(j||(j=(0,T.Z)(["\n  list-style-type: disc;\n  margin-bottom: 6px;\n  margin-left: 15px;\n"]))),D=U.ZP.li(b||(b=(0,T.Z)(["\n  color: #777;\n"]))),_=U.ZP.ul(v||(v=(0,T.Z)(["\n  display: flex;\n  flex-direction: row;\n  flex-wrap: wrap;\n  align-items: center;\n  justify-content: center;\n  gap: 8px;\n"]))),N=U.ZP.li(y||(y=(0,T.Z)(["\n  width: 150px;\n"]))),B=function(){var t=(0,c.useState)([]),e=(0,o.Z)(t,2),n=e[0],r=e[1],i=localStorage.getItem("token");return(0,c.useEffect)((function(){fetch("http://localhost:3000/api/trips",{headers:{Authorization:"Bearer ".concat(i)}}).then((function(t){return t.json()})).then((function(t){return r(t)})).catch((function(t){return console.error("Error fetching trips:",t)}))}),[i]),(0,g.jsx)(g.Fragment,{children:(0,g.jsx)(L.Z,{gutter:16,children:n.map((function(t){return(0,g.jsx)(P.Z,{span:8,children:(0,g.jsxs)(E.Z,{style:{marginBottom:"15px"},title:t.title,bordered:!1,children:[(0,g.jsx)(F,{children:t.description}),(0,g.jsx)(I,{children:"Categories:"}),(0,g.jsx)("ul",{children:t.categories.map((function(t,e){return(0,g.jsxs)("li",{children:[(0,g.jsx)(w,{children:t.nameCategory}),(0,g.jsx)(A,{children:t.todoList.map((function(t,e){return(0,g.jsx)(D,{children:t.todo},e)}))})]},e)}))}),(0,g.jsxs)("p",{children:["Public: ",t.isPublic?"Yes":"No"]}),t.photos.length>0&&(0,g.jsxs)("div",{children:[(0,g.jsx)("h3",{children:"Photos:"}),(0,g.jsx)(_,{children:t.photos.map((function(t,e){return(0,g.jsx)(N,{children:(0,g.jsx)("img",{src:t.cdnUrl,alt:"Photo ".concat(e+1)})},e)}))})]})]})},t._id)}))})})},z=n(8826),O=function(){var t={title:"",description:"",categories:[{nameCategory:"",todoList:[{todo:""}],publicList:!1}],isPublic:!1,photos:[]},e=(0,c.useState)(t),n=(0,o.Z)(e,2),i=n[0],a=n[1],u=(0,c.useState)([]),l=(0,o.Z)(u,2),s=l[0],p=l[1],f=(0,c.useState)([]),x=(0,o.Z)(f,2),m=x[0],Z=x[1],j=(0,c.useState)(null),b=(0,o.Z)(j,2),v=b[0],y=b[1],C=(0,c.useState)(!1),k=(0,o.Z)(C,2),L=k[0],P=k[1],E=(0,c.useState)(null),T=(0,o.Z)(E,2),U=T[0],F=T[1];(0,c.useEffect)((function(){var t=localStorage.getItem("token");fetch("http://localhost:3000/api/trips/keys",{method:"GET",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(t)}}).then((function(t){return t.json()})).then((function(t){F(new z.l7({publicKey:t.publicKey,secretKey:t.secretKey}))})).catch((function(t){console.error("Error fetching keys:",t)}))}),[]),(0,c.useEffect)((function(){var t=JSON.parse(localStorage.getItem("data"));t&&a(t)}),[]),(0,c.useEffect)((function(){localStorage.setItem("data",JSON.stringify(i))}),[i]),(0,c.useEffect)((function(){var t=localStorage.getItem("token");fetch("http://localhost:3000/api/trips",{method:"GET",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(t)}}).then((function(t){return t.json()})).then((function(t){Z(t)})).catch((function(t){console.error("Error fetching trips:",t)}))}),[]);var I=function(t){var e=t.target,n=e.name,o=e.value;a((function(t){return(0,r.Z)((0,r.Z)({},t),{},(0,h.Z)({},n,o))}))};return(0,g.jsxs)(g.Fragment,{children:[(0,g.jsx)("h1",{children:"Form"}),(0,g.jsx)("h2",{children:"Select Trip to Edit"}),(0,g.jsx)("ul",{children:m.map((function(t){return(0,g.jsx)("li",{onClick:function(){return function(t){var e=m.find((function(e){return e._id===t}));a({title:e.title,description:e.description,categories:e.categories.map((function(t){return{nameCategory:t.nameCategory,todoList:t.todoList.map((function(t){return{todo:t.todo}})),publicList:t.publicList}})),isPublic:e.isPublic,photos:e.photos.map((function(t){return{cdnUrl:t.cdnUrl,uuid:t.uuid}}))}),p(e.photos.map((function(t){return t.cdnUrl}))),y(t),P(!0)}(t._id)},children:t.title},t._id)}))}),L&&(0,g.jsxs)(g.Fragment,{children:[(0,g.jsxs)("form",{onSubmit:function(e){e.preventDefault();var n=localStorage.getItem("token"),o="http://localhost:3000/api/trips/".concat(v),c=i.photos.map((function(t){var e=s.find((function(e){return e===t.cdnUrl}));return e?{cdnUrl:e,uuid:t.uuid}:{cdnUrl:t.cdnUrl,uuid:t.uuid}}));s.forEach((function(t){i.photos.find((function(e){return e.cdnUrl===t.cdnUrl}))||c.push({cdnUrl:t.cdnUrl,uuid:t.uuid})}));var u=(0,r.Z)((0,r.Z)({},i),{},{categories:i.categories.map((function(t){return{nameCategory:t.nameCategory,todoList:t.todoList.map((function(t){return{todo:t.todo}})),publicList:t.publicList}})),photos:(0,d.Z)(c)});fetch(o,{method:"PATCH",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(n)},body:JSON.stringify(u)}).then((function(t){return t.json()})).then((function(e){console.log("Response:",e),a(t),localStorage.removeItem("data"),p([])})).catch((function(t){console.error("Error:",t)}))},children:[(0,g.jsx)("label",{htmlFor:"title",children:"Title"}),(0,g.jsx)("input",{type:"text",id:"title",name:"title",value:i.title,onChange:I}),(0,g.jsx)("label",{htmlFor:"description",children:"Description"}),(0,g.jsx)("input",{type:"text",id:"description",name:"description",value:i.description,onChange:I}),(0,g.jsx)("h2",{children:"Categories"}),i.categories.map((function(t,e){return(0,g.jsxs)("div",{children:[(0,g.jsx)("label",{htmlFor:"category-".concat(e),children:"Category Name"}),(0,g.jsx)("input",{type:"text",id:"category-".concat(e),name:"nameCategory",value:t.nameCategory,onChange:function(t){return function(t,e){var n=t.target,o=n.name,i=n.value;a((function(t){var n=(0,d.Z)(t.categories);return n[e]=(0,r.Z)((0,r.Z)({},n[e]),{},(0,h.Z)({},o,i)),(0,r.Z)((0,r.Z)({},t),{},{categories:n})}))}(t,e)}}),(0,g.jsx)("label",{htmlFor:"category-public-".concat(e),children:"Public"}),(0,g.jsx)("input",{type:"checkbox",id:"category-public-".concat(e),name:"publicList",checked:t.publicList,onChange:function(t){return function(t,e){var n=t.target.checked;a((function(t){var o=(0,d.Z)(t.categories);return o[e]=(0,r.Z)((0,r.Z)({},o[e]),{},{publicList:n}),(0,r.Z)((0,r.Z)({},t),{},{categories:o})}))}(t,e)}}),(0,g.jsx)("h3",{children:"Todo List"}),t.todoList.map((function(t,n){return(0,g.jsxs)("div",{children:[(0,g.jsx)("label",{htmlFor:"todo-".concat(e,"-").concat(n),children:"Todo"}),(0,g.jsx)("input",{type:"text",id:"todo-".concat(e,"-").concat(n),name:"todo",value:t.todo,onChange:function(t){return function(t,e,n){var o=t.target.value;a((function(t){var i=(0,d.Z)(t.categories),c=(0,d.Z)(i[e].todoList);return c[n]={todo:o},i[e]=(0,r.Z)((0,r.Z)({},i[e]),{},{todoList:c}),(0,r.Z)((0,r.Z)({},t),{},{categories:i})}))}(t,e,n)}}),(0,g.jsx)("button",{type:"button",onClick:function(){return function(t,e){var n=(0,d.Z)(i.categories);n[t].todoList.splice(e,1),a((function(t){return(0,r.Z)((0,r.Z)({},t),{},{categories:n})}))}(e,n)},children:"Delete Todo"})]},n)})),(0,g.jsx)("button",{type:"button",onClick:function(){return function(t){var e=(0,d.Z)(i.categories);e[t].todoList.push({todo:""}),a((function(t){return(0,r.Z)((0,r.Z)({},t),{},{categories:e})}))}(e)},children:"Add Todo"}),(0,g.jsx)("button",{type:"button",onClick:function(){return function(t){a((function(e){var n=(0,d.Z)(e.categories);return n.splice(t,1),(0,r.Z)((0,r.Z)({},e),{},{categories:n})}))}(e)},children:"Delete Category"})]},e)})),(0,g.jsx)("button",{type:"button",onClick:function(){a((function(t){return(0,r.Z)((0,r.Z)({},t),{},{categories:[].concat((0,d.Z)(t.categories),[{nameCategory:"",todoList:[{todo:""}],publicList:!1}])})}))},children:"Add Category"}),(0,g.jsx)("label",{htmlFor:"isPublic",children:"Public"}),(0,g.jsx)("input",{type:"checkbox",id:"isPublic",name:"isPublic",checked:i.isPublic,onChange:function(t){var e=t.target.checked;a((function(t){return(0,r.Z)((0,r.Z)({},t),{},{isPublic:e})}))}}),(0,g.jsx)("ul",{children:i.photos.map((function(t,e){return(0,g.jsxs)("li",{children:[(0,g.jsx)("img",{src:t.cdnUrl,alt:"Trip photo ".concat(e)}),(0,g.jsx)("button",{onClick:function(){return function(t){var e=(0,d.Z)(i.photos),n=e.splice(t,1)[0];(0,z._I)({uuid:n.uuid},{authSchema:U}).then((function(){console.log("Photo successfully deleted from Uploadcare")})).catch((function(t){console.error("Error deleting photo from Uploadcare:",t)})),a((function(t){return(0,r.Z)((0,r.Z)({},t),{},{photos:e})}))}(e)},children:"Delete"})]},e)}))}),(0,g.jsx)(S,{onCdnUrlsChange:function(t){p(t)}}),(0,g.jsx)("button",{type:"submit",children:"Submit"})]}),(0,g.jsx)("button",{type:"button",onClick:function(){var e=localStorage.getItem("token"),n="http://localhost:3000/api/trips/".concat(v),o=i.photos.map((function(t){return t.uuid}));fetch(n,{method:"DELETE",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(e)}}).then((function(t){return t.json()})).then((function(e){console.log("Trip deleted:",e),a(t),localStorage.removeItem("data"),p([]),P(!1),Z(m.filter((function(t){return t._id!==v})))})).catch((function(t){console.error("Error deleting trip:",t)})),o.length>0&&(0,z.c1)({uuids:o},{authSchema:U}).then((function(){console.log("Photos successfully deleted from Uploadcare: ".concat(o.join(", ")))})).catch((function(t){console.error("Error deleting photos from Uploadcare:",t)}))},children:"Delete Trip"})]})]})},J=U.ZP.div(C||(C=(0,T.Z)(["\n  width: 1262px;\n  margin: 0 auto;\n  padding-left: 15px;\n  padding-right: 15px;\n"]))),K=["children","value","index"];function R(t){var e=t.children,n=t.value,o=t.index,c=(0,i.Z)(t,K);return(0,g.jsx)("div",(0,r.Z)((0,r.Z)({role:"tabpanel",hidden:n!==o,id:"simple-tabpanel-".concat(o),"aria-labelledby":"simple-tab-".concat(o)},c),{},{children:n===o&&(0,g.jsx)(a.Z,{sx:{p:3},children:(0,g.jsx)(s.Z,{children:e})})}))}function G(t){return{id:"simple-tab-".concat(t),"aria-controls":"simple-tabpanel-".concat(t)}}var H=function(){var t=c.useState(0),e=(0,o.Z)(t,2),n=e[0],i=e[1];return(0,g.jsx)(J,{children:(0,g.jsxs)(a.Z,{sx:{width:"100%"},children:[(0,g.jsx)(a.Z,{sx:{borderBottom:1,borderColor:"divider"},children:(0,g.jsxs)(u.Z,{value:n,onChange:function(t,e){i(e)},"aria-label":"user tabs",centered:!0,children:[(0,g.jsx)(l.Z,(0,r.Z)({label:"Add Trip"},G(0))),(0,g.jsx)(l.Z,(0,r.Z)({label:"All Trips"},G(1))),(0,g.jsx)(l.Z,(0,r.Z)({label:"Update Trip"},G(2)))]})}),(0,g.jsx)(R,{value:n,index:0,children:(0,g.jsx)(k,{})}),(0,g.jsx)(R,{value:n,index:1,children:(0,g.jsx)(B,{})}),(0,g.jsx)(R,{value:n,index:2,children:(0,g.jsx)(O,{})})]})})}}}]);
//# sourceMappingURL=431.2a935914.chunk.js.map